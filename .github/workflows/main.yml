name: CI

on: push

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2

      - name: Greeting
        run: echo "Hello, world!"

      - name: Another greeting
        run: echo "Hello, world!"
   
  log-variable:
    runs-on: ubuntu-latest
    
    steps:
    
      - uses: actions/checkout@v2
      
      - name: Set variable
        id: set-variable
        run: |
          if [ -f "index.json" ] 
            then
              jq -c '.results[].suites[]' index.json | while read i; do
                  title=$(echo "$i" | jq '.tests[].title')
                  file=$(echo "$i" | jq '.fullFile')
                  message=$(echo "$i" | jq '.tests[].err.message')
                  report=$(echo "ðŸ§ª TEST: $title | ðŸ“‚ FILE: $file | ðŸ”´ MESSAGE: $message")
                  echo "::set-output name=fail_report::"${report}""
                  echo "$report"
              done

              failures=`cat index.json | jq ".stats.failures"`

              echo "::set-output name=failures_count::"${failures}""
            else
              echo "No failed"
          fi
        
      
      - name: Log variable
        id: log-variable
        run: |
          echo "${{ steps.set-variable.outputs.failures_count }}"
          echo "ðŸ§ª TEST: "User can duplicate a book" | ðŸ“‚ FILE: "cypress/integration/cms/book_duplicate.feature" | ðŸ”´ MESSAGE: "CypressError: sync skip; aborting execution"
ðŸ§ª TEST: "User can delete a chapter"
"User can not delete a chapter" | ðŸ“‚ FILE: "cypress/integration/cms/chapter_delete.feature" | ðŸ”´ MESSAGE: "CypressError: sync skip; aborting execution"
"CypressError: sync skip; aborting execution"
ðŸ§ª TEST: "user can create course"
"user cannot create course (example #1)" | ðŸ“‚ FILE: "cypress/integration/cms/course_create.feature" | ðŸ”´ MESSAGE: "CypressError: sync skip; aborting execution"
"CypressError: sync skip; aborting execution"
ðŸ§ª TEST: "User can search for courses which contains the keyword"
"User can't search for courses which doesn't contain the keyword" | ðŸ“‚ FILE: "cypress/integration/cms/course_search.feature" | ðŸ”´ MESSAGE: "CypressError: sync skip; aborting execution"
"CypressError: sync skip; aborting execution"
ðŸ§ª TEST: "User can download study plan"
"User creates a book, add book into a course. Continue download book and creates new study plan from this book" | ðŸ“‚ FILE: "cypress/integration/cms/course-download-study-plan.feature" | ðŸ”´ MESSAGE: "CypressError: sync skip; aborting execution"
"CypressError: sync skip; aborting execution"
ðŸ§ª TEST: "User can delete a LO (example #1)"
"User can delete a LO (example #2)"
"User can not delete a LO" | ðŸ“‚ FILE: "cypress/integration/cms/LO_delete.feature" | ðŸ”´ MESSAGE: "AssertionError: Timed out retrying after 20000ms: Expected to find element: `[role='alert'][data-testid='SnackbarBase__content']`, but never found it."
null
null
ðŸ§ª TEST: "User can navigate to a valid page in the pdf document"
"User cannot navigate to an invalid page of the pdf document"
"User cannot go to previous page when it is first page of the pdf document"
"User cannot go to next page when it is last page of the pdf document" | ðŸ“‚ FILE: "cypress/integration/cms/question-pagination.feature" | ðŸ”´ MESSAGE: "CypressError: sync skip; aborting execution"
"CypressError: sync skip; aborting execution"
"CypressError: sync skip; aborting execution"
"CypressError: sync skip; aborting execution"
ðŸ§ª TEST: "User can delete a topic" | ðŸ“‚ FILE: "cypress/integration/cms/topic_delete.feature" | ðŸ”´ MESSAGE: "CypressError: sync skip; aborting execution"
ðŸ§ª TEST: "Content creator attaches a video to assignment's materials using embedded Brightcove video link (example #1)"
"Content creator attaches a video to learning object's materials using embedded Brightcove video link (example #2)"
"Content creator cannot attach a video to learning object's materials if that video isn't uploaded in Brightcove yet (video was uploaded to another platform) (example #1)"
"Content creator cannot attach a video to assignment's materials if that video isn't uploaded in Brightcove yet (video was uploaded to another platform) (example #2)" | ðŸ“‚ FILE: "cypress/integration/cms/upload-brightcove-link.feature" | ðŸ”´ MESSAGE: "CypressError: sync skip; aborting execution"
"CypressError: sync skip; aborting execution"
"CypressError: sync skip; aborting execution"
"CypressError: sync skip; aborting execution"
ðŸ§ª TEST: "User updates assignments" | ðŸ“‚ FILE: "cypress/integration/cms/assignment_update.feature" | ðŸ”´ MESSAGE: "CypressError: sync skip; aborting execution""
        
    
    
      

